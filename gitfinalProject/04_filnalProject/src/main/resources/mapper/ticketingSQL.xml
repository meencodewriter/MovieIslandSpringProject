<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ticketing">
<select id="selectSchedule" parameterType="string" resultType="schedule">
	select
		schedule_no as scheduleNo,
		schedule_start as scheduleStart,
		schedule_end as scheduleEnd,
		movuie_title as movieTitle,
		theater_branch as theaterBranch
	from
		schedule_tbl
	where
		to_char(schedule_start, 'dd/mm/yyyy') = #{_parameter}
</select>
<select id="selectOneTheaterBrch" parameterType="_int" resultType="theater">
  	select 
			 	theater_no as theaterNo,
				theater_local as theaterLocal,
				theater_branch as theaterBranch,
				theater_addr as theaterAddr,	
				theater_facility as theaterFacility,
				theater_content as theaterContent,
				enroll_member as EnrollMember		
	  from theater_tbl
	  where theater_no = #{_parameter}
</select>
<select id="choiceDayTheater" parameterType="map" resultType="_int">
	SELECT 
		COUNT(*) 
	FROM 
		THEATER_TBL 
	JOIN SCHEDULE_TBL USING(THEATER_BRANCH) 
	WHERE MOVIE_TITLE = #{movieTitle} 
		AND to_CHAR(SCHEDULE_START, 'DD/MM/YYYY') 
		= #{choiceDataDay} GROUP BY THEATER_LOCAL
</select>  
</mapper>
